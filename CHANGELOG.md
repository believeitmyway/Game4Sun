# 変更履歴

## v2.1 - 2024-11-08

### 新機能 🎉
- **下ネタ機能の設定オプション追加** 💩
  - 設定画面に「下ネタあり」トグルを追加
  - ON/OFFを自由に切り替え可能
  - 設定はlocalStorageに保存され、次回起動時も保持される

### 改善 ✨
- **下ネタ置換ロジックの最適化**
  - 置換確率を10%から50%に増加（テストしやすく、より楽しく）
  - 設定でOFFの場合は完全に無効化
  - 正解選択肢は絶対に置換されないことを保証

### テスト 🧪
- **自動テスト追加**
  - 100回の試行で下ネタ機能の動作を検証
  - 期待値との誤差を確認（40-60%の範囲）
  - 正解位置の保持を確認
  - 正解選択肢が置換されないことを確認
  - **全テスト合格** ✅

### テスト結果サマリー
```
=== テスト1: 下ネタ機能 ON ===
実行回数: 100
下ネタ置換あり: 49回 (49.0%)
通常: 51回
期待値: 約50% (40-60%の範囲が正常)
結果: ✅ PASS

=== テスト2: 下ネタ機能 OFF ===
実行回数: 100
下ネタ置換あり: 0回
期待値: 0回
結果: ✅ PASS

=== テスト3: 正解位置の保持 ===
実行回数: 100
正解位置のエラー: 0回
期待値: 0回
結果: ✅ PASS

=== テスト4: 正解選択肢は置換されない ===
実行回数: 100
正解が置換された回数: 0回
期待値: 0回
結果: ✅ PASS
```

### ファイル更新
- `app.js`: settings に explicitContent フラグを追加、shuffleChoicesWithPoopJoke 関数を更新、toggleExplicitContent 関数を追加
- `index.html`: 設定画面に「下ネタあり」トグルを追加
- `README.md`: 新機能の説明を追加

---

## v2.0 - 2024-11-07

### 新機能
- 派手な演出機能の追加
- パーティクルエフェクト
- 強化された効果音
- 豪華なアニメーション

### 改善
- データ構造のシンプル化
- 問題の追加が容易に

---

## v1.0 - 2024-11-01

### 初回リリース
- 5教科対応
- 2500問以上の問題
- 苦手問題優先出題
- 成績管理機能
